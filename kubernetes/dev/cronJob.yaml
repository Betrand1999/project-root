apiVersion: batch/v1
kind: CronJob
metadata:
  name: cron
  namespace: job
spec:
  schedule: "*/5 * * * *"
  concurrencyPolicy: Forbid
  successfulJobsHistoryLimit: 1 # ✅ Only keep the most recent success
  failedJobsHistoryLimit: 1 # ✅ Keep 1 failure if it happens
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: hello
              image: busybox
              command:
                [
                  "/bin/sh",
                  "-c",
                  "mkdir -p /output && echo 'Hello from Kubernetes CronJob Writing By Betrand Mutagha' > /output/cronjob.txt && sleep 300",
                ]
          restartPolicy: Never
# Kubernetes automatically creates a new Job
# That Job spins up a new pod
# Inside that pod, the command you defined is executed
# create a file output and echo Hello from Kubernetes CronJob
# Kubernetes automatically deletes old pods created by the CronJob after a certain time

###### job ########
# Do samething just that it runs once

# TEST kubectl exec -it job-hbn2j -n job -- sh AND cat /output/job-output.txt

